## Module Introduction
  This is turing an online only Angular application into an offline available one by adding a service worker. This is an easy process and then to configure it to fully meet all the needs. In a typical Angular app there will be a place that holds the jsonplaceholder.typicode.com/posts... this is how we will retrieve the information needed access. 

  Go into the developer tools in the application folder and turn the service workers to offline mode and that means we are still online and do not need to quit the Wi-Fi network. This will simulate what it would be like if we did not have any internet connection. Now lets add a service worker in order to keep the app working even if its offline. 

## Adding Service Worker

  What is a service worker? 
    This is a single thread similar to the main JS code. The important part of this thread is kind of decoupled from the HTML pages. This means that it can continue running in the backgroud of the browser (i.e. on mobile phones). They can also recieve push notifications in advanced functions. A service worker can also manage all of the different pages or the single page if building an app. It can also listen to outgoing networks request such as fetching assests of that webpage (Css code, JS, or font) also data from an API. The service worker can cache these outgoing requests and cache the responses in a sprcial cache storage or return these cache responses back to the page. This allows it to work without internet connection but only if there is a cached version avilable. 

    The service worker can be seen as a proxy between the front end app and the HTTP request is sending to the backend. It then proxies the request or caches it and then does something with it. It is possible to write the service worker from scratch and is something that will be learned more indepth later on (backend). 

## Add Angular Service to application

    Angular can easily add a service worker to our app thanks to a special package that can be installed. 
        ng add @angular/pwa

    This will configure your existing project to use the angular service worker package and start with a pre-configured service worker. This will do a lot for you and it also adds some things to the index HTML file like the noscript section to give a warning if JS is turned off. It also loads and autogenerates the manifest.json and is impt for having a launcher icon for your app. This will also allow you to save to a home screen on a mobile phone. 

    In the app module we are using a service worker module and is imported. The file will be autogenerated for you with the information needed and this will be in the dist folder and it holds the service worker. A new file added was the 
        ngsw-config.json
    This is the file that will allow you to configure the service worker that is generated. 

## Lets See it in Action

    Lets create a production build by running 
        ng build --prod
    This will bundle and optimize the entire app, use ahead of time complication... Then this will change the   ngsw-worker.js file
    This will also import it into the app.module bc we generated it in the termainal. In this ngsw-worker.js file holds a lot of code that is pre-generated to do all of the cacheing. 

    Now we need a web server to run to host the production app. Now we need to install the lightweight node server ...
          npm install -g http-server
    This package can be used to launch a simple node-based server that will host the content off the folder to run the command. The command you need to run is just http-server . However...

    We need to first naviagate into our dist folder in the terminal by..
          cd dist/angular/pwa

          then run...

          http-server -p 8081

    Now you can visit the local host 8081 to see the Angular app. Reload this a few times just to ensure that the service worker is doing its job. Now go to the inspect and application part of it. In the application we should see that the ngsw-worker is running. If its not seen then try to reload the page again to see if that helps to configrue it. Also make sure to clear the storage here entirely on the right hand side of the application in the inspect tab. 

## Caching Assests for Offline
    Assest groups are configurations that define which static assset should be cached and how they should be cached. Dynamic assests would be the data from the API. The data we are fetching and that might change on that API. Dynamic means that is it changing and it can also affect our HMTL file and JS code will change with every build but after it will be static. 

    How should assests be loaded? 
        Prefetch means that when your page loads Angular/Service worker will go ahead and prefetch all the assets that are specified in this assest group. This will put it into the cache even is we haven't needed them yet. The alternative to the prefetch is lazy and this will only load them once you need them. "assestGroups" are static based and that just means constant. 

        There is also an update mode adn this is important for the case that you're pushing a new version of your Angular app and therefore also of the service worker. To the server and the user is already browsing on that server and will get informed about the new service worker. 

        The assests that should be loaded are the resources. The resources has one key property- the files. This then has an array pointing to the files you want to cache. 



## Caching Dynamic Assests & URLs
    Add a new configuration item of "dataGroups" and typically data that is requested from the API, data that might change frequently. 

    How is the data group configured?
        It is an array because its dataGroups here but yet one dataGroup is an object. Set it up similar to this while the label of things can be different. 

          "dataGroups": [
            {
              "name": "posts",
              "urls": [
                the url from the app.comp. for the <post> aspect... jsonplaceholder...
              ],
              "cacheConfig": {
                "maxSize": 5,
                "maxAge": "6h",
                "timeout": "10s",
                "strategy": "freshness"
              }
            }
          ]

      "cacheConfig" is to be configure how the data should be cached. "maxSize" is how many entries you want to cache NOT how many posts. This is how many responses you want to cache. "maxAge" is how old the data in the cache should be before we get rid of it and definitely fetch new data. Want to make sure that the data in the cache is still vailid and if not we need to fetch new data. This needs to be defined as a string like above. "timeout" is how long you will wait before response. The "strategy" can be two types: freshness- always try to reach out to the backend first and only use the cache if offline. Performance tries to get something onto the screen as quick as possible and it will take maxAge into account to know whether it should absolutely reach out to the backend or just use the cache value. 


    Now build this again and make sure you 
        cd dist/angular-pwa 
    Then ng build --prod  and now serve it to ensure that it works in the offline mode. It may take closing and reopening a time or two to ensure that it will opperate properly with the sever worker. 